<!DOCTYPE html>
<html>
<head>
    <title>Spirit Level App</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <style>
        body {
            height: 100%;
            width: 100%;
            background-color: rgb(30, 30, 30);
        }
        
        #level_case {
            background-image: url(Level_case.jpg);
            height: 73.7px;
            width: 735px;
            margin: auto;
            padding-top: 2.3px;
        }
        
        /* left of bubble housing starts at 210px left and ends at 457px*/
        
        #level_bubble {
            background-color: white;
            height: 15px;
            width: 44px;
            margin: 0;
            border: 2px solid black;
            border-radius: 40%;
            position: relative;
            left: 342.52px;
        }
        
        #angleDisp {
            font-family: sans-serif;
            color: white;
            font-size: 1.5em;
            margin: auto;
            margin-top: 25px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="level_case">
        <div id="level_bubble"></div>
    </div>
    <div id="angleDisp"></div>
    <div id=CAt_logo></div>
    
    <script>
        window.addEventListener("deviceorientation", handleIt);
        var disp = document.getElementById("angleDisp");
        var gamma = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        var beta = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        var alpha = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        
        function handleIt(ori)
        {
            var gammaInst = ori.gamma;
            var betaInst = ori.beta;
            var alphaInst = ori.alpha;
            
            if(gammaInst >= 0 && gammaInst <= 180) {
                gamma.push(gammaInst);
            } else if (gammaInst < 0) {
                gamma.push(360 + gammaInst);
            };
            gamma.shift();
            
            if(betaInst >= 0 && betaInst <= 180) {
                beta.push(betaInst);
            } else if(betaInst < 0) {
                beta.push(360 + betaInst);
            };
            beta.shift();
            
            if(alphaInst >= 0 && alphaInst <= 180) {
                alpha.push(alphaInst);
            } else if(alphaInst < 0) {
                alpha.push(360 + alphaInst);
            };
            alpha.shift();
            
            var gammaSum = 0;
            var betaSum = 0;
            var alphaSum = 0;
            
            for(var i = 0; i < gamma.length; i++) 
            {
                gammaSum += gamma[i];
                betaSum += beta[i];
                alphaSum += alpha[i];
            }
            
            var gammaAvg = Math.round(gammaSum/gamma.length);
            var betaAvg = Math.round(betaSum/beta.length);
            var alphaAvg = Math.round(alphaSum/alpha.length);
            
            disp.innerHTML = "Gamma: " + gammaAvg + "<br/>" + "Beta: " + betaAvg + "<br/>" + "Alpha: "  + alphaAvg;
        }
    </script>
</body>
</html>
